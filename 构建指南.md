# 影藏·媒体管理器 - 一键构建指南

## 🚀 快速开始

### Windows 用户
```
双击运行：一键构建.bat
```

### Linux/macOS 用户
```bash
./auto_build.sh
```

### 或使用 Python 直接运行
```bash
python auto_build.py
```

---

## ✨ 功能特性

✅ **自动检查环境** - 自动检测并安装依赖
✅ **自动安装 PyInstaller** - 无需手动配置
✅ **自动生成版本号** - 智能版本管理
✅ **自动清理旧构建** - 保持环境整洁
✅ **自动编译中文翻译** - 确保完整中文界面
✅ **自动构建可执行文件** - 单文件 EXE
✅ **自动创建便携版** - 免安装运行
✅ **自动生成安装包** - 专业 Windows 安装程序
✅ **全过程日志记录** - 详细记录每一步

---

## 📦 输出文件

构建完成后，在 `package/` 目录下：

```
package/
├── MediaManager.exe                    # 可执行文件
├── MediaManager-Portable-{版本}.zip    # 便携版压缩包
├── MediaManager-Setup-{版本}.exe       # 安装程序
├── BUILD_REPORT_*.txt                  # 构建报告
└── BUILD_INFO_*.json                   # 构建信息
```

---

## 📋 系统要求

- **Python**: 3.8 或更高版本
- **操作系统**: Windows 7+, macOS 10.13+, Linux
- **磁盘空间**: 至少 2GB
- **内存**: 建议 4GB 或以上

**可选工具:**
- Inno Setup 6（用于创建 Windows 安装程序）
  下载: https://jrsoftware.org/isdl.php

---

## 🔍 构建流程

```
1. 检查环境 → 2. 安装 PyInstaller → 3. 生成版本号
                         ↓
4. 清理旧构建 → 5. 编译中文翻译 → 6. 构建可执行文件
                         ↓
7a. 创建便携版 → 7b. 创建安装包 → 8. 生成构建报告
                         ↓
                    ✓ 完成！
```

---

## 📝 日志文件

所有日志保存在 `build_logs/` 目录：
```
build_logs/
└── build_{时间戳}.log    # 详细构建日志
```

---

## ❓ 常见问题

### Q1: 提示找不到 Python？
**A:** 安装 Python 3.8+ 并确保添加到 PATH
   下载: https://www.python.org/downloads/

### Q2: 提示缺少依赖包？
**A:** 脚本会自动安装，如果失败请手动运行：
   ```bash
   pip install pyinstaller PySide6 sqlalchemy sqlmodel requests
   ```

### Q3: 没有生成安装程序？
**A:** 需要安装 Inno Setup，或使用已生成的便携版

### Q4: 生成的 EXE 文件很大？
**A:** 这是正常的（约 80-150MB），包含完整 Python 环境

### Q5: 如何验证文件完整性？
**A:** 使用构建报告中的 SHA256 哈希值验证

---

## 🧪 测试构建系统

运行测试脚本检查环境：
```bash
python test_auto_build.py
```

---

## 📖 详细文档

查看 `AUTO_BUILD_README.md` 获取完整文档

---

## 💡 提示

1. 首次构建会下载依赖，需要较长时间
2. 构建过程中会占用较多 CPU 和内存
3. 建议在构建前关闭杀毒软件的实时防护
4. 构建完成后记得测试生成的程序

---

**影藏·媒体管理器** - 影视媒体管理专家
